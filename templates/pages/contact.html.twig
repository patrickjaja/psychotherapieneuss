{% extends 'base.html.twig' %}

{% block title %}Kontakt - Psychotherapie Neuss{% endblock %}

{% block content %}
<section class="py-12 bg-gradient-to-b from-primary/10 to-white">
    <div class="container mx-auto px-4">
        <h1 class="text-4xl font-bold text-center mb-8">Kontakt und Anfahrt</h1>
        <p class="text-lg text-center max-w-3xl mx-auto">
            Nehmen Sie Kontakt auf und ich melde mich schnellstmöglich zurück! Nutzen Sie einfach das untenstehende Kontaktformular, um mir direkt eine Nachricht zu schicken. Ich bemühe mich, so schnell wie möglich zu antworten. Vielen Dank für Ihr Interesse, ich freue mich auf Ihre Nachricht.
        </p>
    </div>
</section>

<section class="py-16">
    <div class="container mx-auto px-4">
        <div class="max-w-6xl mx-auto">
            <div class="grid lg:grid-cols-2 gap-12">
                <div>
                    <div class="bg-white rounded-lg shadow-lg p-8">
                        <h2 class="text-2xl font-bold mb-6">Kontaktformular</h2>
                        
                        <form id="contact-form" class="space-y-6">
                            <div>
                                <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                                    Name <span class="text-red-500">*</span>
                                </label>
                                <input type="text" id="name" name="name" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-colors"
                                    placeholder="Ihr Name">
                            </div>
                            
                            <div>
                                <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                                    E-Mail-Adresse <span class="text-red-500">*</span>
                                </label>
                                <input type="email" id="email" name="email" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-colors"
                                    placeholder="ihre.email@beispiel.de">
                            </div>
                            
                            <div>
                                <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
                                    Telefonnummer <span class="text-red-500">*</span>
                                </label>
                                <input type="tel" id="phone" name="phone" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-colors"
                                    placeholder="+49 123 456789">
                            </div>
                            
                            <div>
                                <label for="appointment_timeframe" class="block text-sm font-medium text-gray-700 mb-2">
                                    Wunschtermin <span class="text-red-500">*</span>
                                </label>
                                <select id="appointment_timeframe" name="appointment_timeframe" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-colors bg-white text-gray-900 appearance-none cursor-pointer">
                                    <option value="">Bitte wählen Sie einen Zeitraum</option>
                                    <option value="innerhalb_einer_woche">Innerhalb einer Woche</option>
                                    <option value="innerhalb_zwei_wochen">Innerhalb von zwei Wochen</option>
                                    <option value="innerhalb_eines_monats">Innerhalb eines Monats</option>
                                    <option value="innerhalb_zwei_monate">Innerhalb von zwei Monaten</option>
                                    <option value="flexibel">Ich bin zeitlich flexibel</option>
                                </select>
                            </div>
                            
                            <div>
                                <label for="message" class="block text-sm font-medium text-gray-700 mb-2">
                                    Ihre Nachricht <span class="text-red-500">*</span>
                                </label>
                                <textarea id="message" name="message" rows="5" required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition-colors resize-none"
                                    placeholder="Guten Tag, gerne würde ich einen Termin vereinbaren und bitte um Rückruf."></textarea>
                            </div>
                            
                            <!-- Honeypot field - hidden from users -->
                            <div style="position: absolute; left: -5000px;" aria-hidden="true">
                                <input type="text" name="website" tabindex="-1" autocomplete="off">
                            </div>
                            
                            <!-- Time-based protection -->
                            <input type="hidden" name="form_time" value="{{ "now"|date("U") }}">
                            
                            <div id="form-message" class="hidden">
                                <div class="p-4 rounded-lg"></div>
                            </div>
                            
                            <button type="submit" id="submit-button"
                                class="w-full bg-primary text-white py-3 px-6 rounded-lg font-semibold hover:bg-primary/90 transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2">
                                Nachricht senden
                            </button>
                        </form>
                    </div>
                </div>
                
                <div class="space-y-8">
                    <div class="bg-white rounded-lg shadow-lg p-8">
                        <h2 class="text-2xl font-bold mb-6">Kontaktdaten</h2>
                        
                        <div class="space-y-4">
                            <div class="flex items-start">
                                <svg class="w-6 h-6 text-primary mt-1 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                </svg>
                                <div>
                                    <p class="font-semibold">Adresse</p>
                                    <p class="text-gray-600">Kanalstr. 49<br>41460 Neuss</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <svg class="w-6 h-6 text-primary mt-1 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                </svg>
                                <div>
                                    <p class="font-semibold">E-Mail</p>
                                    <a href="mailto:info@psychotherapieneuss.de" class="text-primary hover:text-primary/80">
                                        info@psychotherapieneuss.de
                                    </a>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <svg class="w-6 h-6 text-primary mt-1 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                </svg>
                                <div>
                                    <p class="font-semibold">Telefon</p>
                                    <p class="text-gray-600">Auf Anfrage</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                        <img src="/images/Kontakt.jpg" alt="Kontakt" class="w-full h-64 object-cover">
                    </div>
                </div>
            </div>
            
            <div class="mt-12 bg-white rounded-lg shadow-lg overflow-hidden">
                <div class="bg-gray-100 p-6">
                    <h2 class="text-2xl font-bold">Anfahrt</h2>
                </div>
                <div class="p-6">
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="font-semibold text-lg mb-4 flex items-center">
                                <svg class="w-6 h-6 text-primary mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
                                </svg>
                                Mit öffentlichen Verkehrsmitteln
                            </h3>
                            <ul class="space-y-2 text-gray-700">
                                <li class="flex items-center">
                                    <span class="text-primary mr-2">•</span>
                                    <span><strong>Bushaltestelle Neustr.</strong> - 300m</span>
                                </li>
                                <li class="flex items-center">
                                    <span class="text-primary mr-2">•</span>
                                    <span><strong>Neuss Hbf</strong> - 1,2km</span>
                                </li>
                                <li class="flex items-center">
                                    <span class="text-primary mr-2">•</span>
                                    <span><strong>Zolltor</strong> - 500m</span>
                                </li>
                                <li class="flex items-center">
                                    <span class="text-primary mr-2">•</span>
                                    <span><strong>Glockhammer</strong> - 550m</span>
                                </li>
                                <li class="flex items-center">
                                    <span class="text-primary mr-2">•</span>
                                    <span><strong>Landestheater</strong> - 700m</span>
                                </li>
                                <li class="flex items-center">
                                    <span class="text-primary mr-2">•</span>
                                    <span><strong>Friedrich-Ebert-Platz</strong> - 700m</span>
                                </li>
                            </ul>
                        </div>
                        
                        <div>
                            <h3 class="font-semibold text-lg mb-4 flex items-center">
                                <svg class="w-6 h-6 text-primary mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                                Mit dem Auto
                            </h3>
                            <p class="text-gray-700 mb-3">
                                <strong>Hinweis:</strong> Umliegende Straßen nur mit Parkticket
                            </p>
                            <ul class="space-y-2 text-gray-700">
                                <li class="flex items-center">
                                    <span class="text-primary mr-2">•</span>
                                    <span><strong>Parkhaus Sparkasse</strong> - 400m</span>
                                </li>
                                <li class="flex items-center">
                                    <span class="text-primary mr-2">•</span>
                                    <span><strong>Parkhaus Rathausgarage</strong> - 500m</span>
                                </li>
                                <li class="flex items-center">
                                    <span class="text-primary mr-2">•</span>
                                    <span><strong>Parkhaus Niedertor</strong> - 750m</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="mt-8">
                        <iframe 
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2491.123456789!2d6.688499!3d51.198765!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47b8b5a4c0000000%3A0x0000000000000000!2sKanalstra%C3%9Fe%2049%2C%2041460%20Neuss!5e0!3m2!1sde!2sde!4v1234567890"
                            width="100%" 
                            height="400" 
                            style="border:0;" 
                            allowfullscreen="" 
                            loading="lazy"
                            class="rounded-lg">
                        </iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}

{% block scripts %}
<script>
document.getElementById('contact-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    const submitButton = document.getElementById('submit-button');
    const formMessage = document.getElementById('form-message');
    const messageDiv = formMessage.querySelector('div');
    
    // Disable submit button
    submitButton.disabled = true;
    submitButton.textContent = 'Wird gesendet...';
    
    // Collect form data
    const formData = new FormData(this);
    
    try {
        const response = await fetch('/kontakt/senden', {
            method: 'POST',
            body: formData
        });
        
        const result = await response.json();
        
        if (response.ok) {
            // Success
            messageDiv.className = 'p-4 rounded-lg bg-green-100 text-green-700';
            messageDiv.textContent = result.message || 'Ihre Nachricht wurde erfolgreich gesendet.';
            formMessage.classList.remove('hidden');
            
            // Reset form
            this.reset();
            
            // Scroll to message
            formMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        } else {
            // Error
            messageDiv.className = 'p-4 rounded-lg bg-red-100 text-red-700';
            if (result.errors) {
                messageDiv.innerHTML = '<strong>Bitte korrigieren Sie folgende Fehler:</strong><ul class="mt-2 list-disc list-inside">' + 
                    result.errors.map(error => '<li>' + error + '</li>').join('') + '</ul>';
            } else {
                messageDiv.textContent = result.error || 'Ein Fehler ist aufgetreten. Bitte versuchen Sie es später erneut.';
            }
            formMessage.classList.remove('hidden');
        }
    } catch (error) {
        // Network error
        messageDiv.className = 'p-4 rounded-lg bg-red-100 text-red-700';
        messageDiv.textContent = 'Ein Netzwerkfehler ist aufgetreten. Bitte überprüfen Sie Ihre Internetverbindung.';
        formMessage.classList.remove('hidden');
    } finally {
        // Re-enable submit button
        submitButton.disabled = false;
        submitButton.textContent = 'Nachricht senden';
    }
});
</script>
{% endblock %}